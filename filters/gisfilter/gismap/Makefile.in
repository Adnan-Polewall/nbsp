#
# Copyright (c) 2005 Jose F. Nieves <nieves@ltp.upr.clu.edu>
#
# See LICENSE
#
# $Id$
#
@include@ @q@../../../Makefile.inc@q@

TCLTARGET =	nbspgismap1 nbspgismap
TCLSOURCES =	nbspgismap1.tcl nbspgismap.tcl

TMPLTARGET =    gismap-templates.tgz
TMPLPDIR =      gismap
TMPLSOURCES1 =	map_sat_conus.tmpl
TMPLSOURCES2 =	
TMPLDIR1 =      ${TMPLPDIR}/sat
TMPLDIR2 =      ${TMPLPDIR}/rad

SHAREFILES =	geodata-share.tgz

SAMPLES =	gismap.conf-sample
DEFAULTS =	gismap.conf-defaults

TARGET =	${TCLTARGET} ${TMPLTARGET} ${SAMPLES}

TCLSH =		@TCLSH@
INSTALL =	@INSTALL@

all: ${TARGET}

nbspgismap1: nbspgismap1.tcl
	sed -e /%TCLSH%/s##${TCLSH}# nbspgismap1.tcl > nbspgismap1

nbspgismap: nbspgismap.tcl
	sed -e /%TCLSH%/s##${TCLSH}# nbspgismap.tcl > nbspgismap

gismap.conf-sample: gismap.conf
	cp gismap.conf gismap.conf-sample

#geodata-share.tgz:
#	tar -c @EXCLUDE@'*.svn*' -z -f geodata-share.tgz geodata

${TMPLTARGET}: ${TMPLSOURCES}
	rm -rf ${TMPLPDIR}
	mkdir -p ${TMPLDIR1} ${TMPLDIR2}
	cp ${TMPLSOURCES1} ${TMPLDIR1}
#	cp ${TMPLSOURCES2} ${TMPLDIR2}
	tar -czf ${TMPLTARGET} ${TMPLPDIR}

install: ${TARGET}
	${INSTALL} -m 755 ${TCLTARGET} ${BINDIR}
	${INSTALL} -m 644 ${SAMPLES} ${TMPLTARGET} ${DEFAULTS} ${MYCONFDIR}
	${INSTALL} -m 644 ${SHAREFILES} ${MYSHAREDIR}

clean:
	rm -f *~ Makefile ${TARGET}
	rm -rf ${TMPLPDIR}
